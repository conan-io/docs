<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Capturing Git scm information &mdash; conan 2.7.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=2da93098" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/css/conan.css?v=7d9e9f1e" />

  
    <link rel="shortcut icon" href="../../../../../_static/conan-favicon.png"/>
    <link rel="canonical" href="https://docs.conan.io/examples/tools/scm/git/capture_scm/git_capture_scm.html" />
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../../../_static/documentation_options.js?v=7b940564"></script>
        <script src="../../../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="MSBuild" href="../../../microsoft/msbuild.html" />
    <link rel="prev" title="Create your first Conan package with Autotools in Windows (msys2)" href="../../../autotools/create_your_first_package_windows.html" />


<script
  data-cfasync="false"
  data-tracker-overrides="GoogleConsentMode:security_storage=on;ad_storage=SaleOfInfo,Advertising;ad_user_data=SaleOfInfo,Advertising;ad_personalization=SaleOfInfo,Advertising;analytics_storage=Analytics,SaleOfInfo;functionality_storage=Functional,SaleOfInfo;personalization_storage=Functional,SaleOfInfo"
  src="https://transcend-cdn.com/cm/f0071674-c641-4cf3-9d31-303ec0c86b1b/airgap.js" data-languages="en"
></script>
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://gtm.jfrog.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-WK44ZFM');</script>
<!-- End Google Tag Manager -->
<script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {dataLayer.push(arguments);}
      gtag("js", new Date());
      gtag("config", "GTM-WK44ZFM");
      gtag('set', 'developer_id.dODQ2Mj', true);
</script>

 



</script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../index.html">
            
              <img src="../../../../../_static/conan-docs-logo-2.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2.7
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../whatsnew.html">What‚Äôs new in Conan 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../installation.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../devops.html">Devops guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../integrations.html">Integrations</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../../conanfile.html">ConanFile methods examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../extensions.html">Conan extensions examples</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../../tools.html">Conan recipe tools examples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../cmake/cmake.html">CMake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../files/files.html">File interaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../meson/meson.html">Meson</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../google/bazel.html">Bazel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autotools/autotools.html">Autotools</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Capturing Git scm information</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../microsoft/msbuild.html">MSBuild</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../cross_build.html">Cross-building examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../config_files.html">Configuration files examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../graph.html">Graph examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../dev_flow.html">Developer tools and flows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../commands.html">Conan commands examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../runners.html">Conan runners examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../knowledge.html">Knowledge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../changelog.html">Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">conan</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div class="admonition warning wy-text-center" style="position:sticky;top:0;background: #fcfcfc;padding: inherit;z-index:1" id="conan-banners">
            
            <div style="border: 2px solid #4a7d7e; background-color: #e6f2f2; padding: 8px">
                <p>
                  üìñ The complete Conan 2 training is now available for free on
                  JFrog Academy: <a
                  href="https://academy.jfrog.com/path/conan-cc-package-manager?utm_source=Conan+Docs"
                  target="_blank">Essentials</a> and <a
                  href="https://academy.jfrog.com/path/conan-2-advanced?utm_source=Conan+Docs"
                  target="_blank">Advanced</a>.
                </p>
              </div>                                                  
          </div>
          
          <div>
            <div class="admonition warning wy-text-center" style="position:sticky">
              <p>This document is for an <b>outdated</b> Conan version.
              <a href="https://docs.conan.io/2/examples/tools/scm/git/capture_scm/git_capture_scm.html">Click here to read the <b>latest</b> documentation</a></p>
             </div>
          </div>
          
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../../examples.html">Examples</a></li>
          <li class="breadcrumb-item"><a href="../../../../tools.html">Conan recipe tools examples</a></li>
      <li class="breadcrumb-item active">Capturing Git scm information</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="capturing-git-scm-information">
<span id="examples-tools-scm-git-capture"></span><h1>Capturing Git scm information<a class="headerlink" href="#capturing-git-scm-information" title="Link to this heading">¬∂</a></h1>
<p>There are 2 main strategies to handle source code in recipes:</p>
<ul class="simple">
<li><p><strong>Third-party code</strong>: When the <code class="docutils literal notranslate"><span class="pre">conanfile.py</span></code> recipe is packaging third party code, like an open source library, it is typically better to use the <code class="docutils literal notranslate"><span class="pre">source()</span></code> method to download or clone the sources of that library. This is the approach followed by the <code class="docutils literal notranslate"><span class="pre">conan-center-index</span></code> repository for ConanCenter.</p></li>
<li><p><strong>Your own code</strong>: When the <code class="docutils literal notranslate"><span class="pre">conanfile.py</span></code> recipe is packaging your own code, it is typically better to have the <code class="docutils literal notranslate"><span class="pre">conanfile.py</span></code> in the same repository as the sources. Then, there are 2 alternatives for achieving reproducibility:</p>
<ul>
<li><p>Using the <code class="docutils literal notranslate"><span class="pre">exports_sources</span></code> (or <code class="docutils literal notranslate"><span class="pre">export_source()</span></code> method) to capture a copy of the sources together with the recipe in the Conan package. This is very simple and pragmatic and would be recommended for the majority of cases.</p></li>
<li><p>For cases when it is not possible to store the sources beside the Conan recipe, for example when the package is to be consumed for someone that shouldn‚Äôt have access to the source code at all, then the current <strong>scm capture</strong> method would be the way.</p></li>
</ul>
</li>
</ul>
<p>In the <strong>scm capture</strong> method, instead of capturing a copy of the code itself, the ‚Äúcoordinates‚Äù for that code are captured instead, in the <code class="docutils literal notranslate"><span class="pre">Git</span></code> case, the <code class="docutils literal notranslate"><span class="pre">url</span></code> of the repository and the <code class="docutils literal notranslate"><span class="pre">commit</span></code>. If the recipe needs to build from source, it will use that information to get a clone, and if the user who tries that is not authorized, the process will fail. They will still be able to use the pre-compiled binaries that we distribute, but not build from source or have access to the code.</p>
<p>Let‚Äôs see how it works with an example. Please, first clone the sources to recreate this project. You can find them in the
<a class="reference external" href="https://github.com/conan-io/examples2">examples2 repository</a> on GitHub:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/conan-io/examples2.git
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>examples2/examples/tools/scm/git/capture_scm
</pre></div>
</div>
<p>There we will find a small ‚Äúhello‚Äù project, containing this <code class="docutils literal notranslate"><span class="pre">conanfile.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">conan</span><span class="w"> </span><span class="kn">import</span> <span class="n">ConanFile</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">conan.tools.cmake</span><span class="w"> </span><span class="kn">import</span> <span class="n">CMake</span><span class="p">,</span> <span class="n">cmake_layout</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">conan.tools.scm</span><span class="w"> </span><span class="kn">import</span> <span class="n">Git</span>


<span class="k">class</span><span class="w"> </span><span class="nc">helloRecipe</span><span class="p">(</span><span class="n">ConanFile</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;hello&quot;</span>
    <span class="n">version</span> <span class="o">=</span> <span class="s2">&quot;0.1&quot;</span>

    <span class="c1"># Binary configuration</span>
    <span class="n">settings</span> <span class="o">=</span> <span class="s2">&quot;os&quot;</span><span class="p">,</span> <span class="s2">&quot;compiler&quot;</span><span class="p">,</span> <span class="s2">&quot;build_type&quot;</span><span class="p">,</span> <span class="s2">&quot;arch&quot;</span>
    <span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;shared&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="s2">&quot;fPIC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]}</span>
    <span class="n">default_options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;shared&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;fPIC&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
    <span class="n">generators</span> <span class="o">=</span> <span class="s2">&quot;CMakeDeps&quot;</span><span class="p">,</span> <span class="s2">&quot;CMakeToolchain&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">export</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">git</span> <span class="o">=</span> <span class="n">Git</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipe_folder</span><span class="p">)</span>
        <span class="c1"># save the url and commit in conandata.yml</span>
        <span class="n">git</span><span class="o">.</span><span class="n">coordinates_to_conandata</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">source</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># we recover the saved url and commit from conandata.yml and use them to get sources</span>
        <span class="n">git</span> <span class="o">=</span> <span class="n">Git</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">git</span><span class="o">.</span><span class="n">checkout_from_conandata_coordinates</span><span class="p">()</span>

    <span class="o">...</span>
</pre></div>
</div>
<p>We need this code to be in its own Git repository, to see how it works in the real case, so
please create a folder outside of the <code class="docutils literal notranslate"><span class="pre">examples2</span></code> repository, and copy the contents of the current folder there, then:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ mkdir /home/myuser/myfolder # or equivalent in other OS
$ cp -R . /home/myuser/myfolder # or equivalent in other OS
$ cd /home/myuser/myfolder # or equivalent in other OS

# Initialize the git repo
$ git init .
$ git add .
$ git commit . -m wip
# Finally create the package
$ conan create .
...
======== Exporting recipe to the cache ========
hello/0.1: Exporting package recipe: /myfolder/conanfile.py
hello/0.1: Calling export()
hello/0.1: RUN: git status . --short --no-branch --untracked-files
hello/0.1: RUN: git rev-list HEAD -n 1 --full-history -- &quot;.&quot;
hello/0.1: RUN: git remote -v
hello/0.1: RUN: git branch -r --contains cb7815a58529130b49da952362ce8b28117dee53
hello/0.1: RUN: git fetch origin --dry-run --depth=1 cb7815a58529130b49da952362ce8b28117dee53
hello/0.1: WARN: Current commit cb7815a58529130b49da952362ce8b28117dee53 doesn&#39;t exist in remote origin
This revision will not be buildable in other computer
hello/0.1: RUN: git rev-parse --show-toplevel
hello/0.1: Copied 1 &#39;.py&#39; file: conanfile.py
hello/0.1: Copied 1 &#39;.yml&#39; file: conandata.yml
hello/0.1: Exported to cache folder: /.conan2/p/hello237d6f9f65bba/e
...
======== Installing packages ========
hello/0.1: Calling source() in /.conan2/p/hello237d6f9f65bba/s
hello/0.1: Cloning git repo
hello/0.1: RUN: git clone &quot;&lt;hidden&gt;&quot;  &quot;.&quot;
hello/0.1: Checkout: cb7815a58529130b49da952362ce8b28117dee53
hello/0.1: RUN: git checkout cb7815a58529130b49da952362ce8b28117dee53
</pre></div>
</div>
<p>Let‚Äôs explain step by step what is happening:</p>
<ul class="simple">
<li><p>When the recipe is exported to the Conan cache, the <code class="docutils literal notranslate"><span class="pre">export()</span></code> method executes, <code class="docutils literal notranslate"><span class="pre">git.coordinates_to_conandata()</span></code>,
which stores the Git URL and commit in the <code class="docutils literal notranslate"><span class="pre">conandata.yml</span></code> file by internally calling <code class="docutils literal notranslate"><span class="pre">git.get_url_and_commit()</span></code>.
See the <a class="reference internal" href="../../../../../reference/tools/scm/git.html#conan-tools-scm-git"><span class="std std-ref">Git reference</span></a> for more information about these methods.</p></li>
<li><p>This obtains the URL of the repo pointing to the local <code class="docutils literal notranslate"><span class="pre">&lt;local-path&gt;/capture_scm</span></code> and the commit <code class="docutils literal notranslate"><span class="pre">8e8764c40bebabbe3ec57f9a0816a2c8e691f559</span></code></p></li>
<li><p>It warns that this information will <strong>not</strong> be enough to re-build from source this recipe once the package is uploaded to the server and is tried to be built from source in other computer, which will not contain the path pointed by <code class="docutils literal notranslate"><span class="pre">&lt;local-path&gt;/capture_scm</span></code>. This is expected, as the repository that we created doesn‚Äôt have any remote defined. If our local clone had a remote defined and that remote contained the <code class="docutils literal notranslate"><span class="pre">commit</span></code> that we are building, the <code class="docutils literal notranslate"><span class="pre">scm_url</span></code> would point to the remote repository instead, making the build from source fully reproducible.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">export()</span></code> method stores the <code class="docutils literal notranslate"><span class="pre">url</span></code> and <code class="docutils literal notranslate"><span class="pre">commit</span></code> information in the <code class="docutils literal notranslate"><span class="pre">conandata.yml</span></code> for future reproducibility.</p></li>
<li><p>When the package needs to be built from sources and it calls the <code class="docutils literal notranslate"><span class="pre">source()</span></code> method,
it recovers the information from the <code class="docutils literal notranslate"><span class="pre">conandata.yml</span></code> file inside the <code class="docutils literal notranslate"><span class="pre">git.checkout_from_conandata_coordinates()</span></code> method,
which internally calls <code class="docutils literal notranslate"><span class="pre">git.clone()</span></code> with it to retrieve the sources.
In this case, it will be cloning from the local checkout in <code class="docutils literal notranslate"><span class="pre">&lt;local-path&gt;/capture_scm</span></code>, but if it had a remote defined, it will clone from it.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>To achieve reproducibility, it is very important for this <strong>scm capture</strong> technique that the current checkout is not dirty
If it was dirty, it would be impossible to guarantee future reproducibility of the build, so <code class="docutils literal notranslate"><span class="pre">git.get_url_and_commit()</span></code> can raise errors,
and require to commit changes. If more than 1 commit is necessary, it would be recommended to squash those commits before pushing changes to upstream repositories.</p>
</div>
<p>If we do now a second <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">create</span> <span class="pre">.</span></code>, as the repo is dirty we would get:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ conan create .
hello/0.1: Calling export()
ERROR: hello/0.1: Error in export() method, line 19
    scm_url, scm_commit = git.get_url_and_commit()
    ConanException: Repo is dirty, cannot capture url and commit: .../capture_scm
</pre></div>
</div>
<p>This could be solved by cleaning the repo with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">clean</span> <span class="pre">-xdf</span></code>, or by adding a <code class="docutils literal notranslate"><span class="pre">.gitignore</span></code> file to the repo with the following contents
(which might be a good practice anyway for source control):</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">.gitignore</span><a class="headerlink" href="#id1" title="Link to this code">¬∂</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>test_package/build
test_package/CMakeUserPresets.json
</pre></div>
</div>
</div>
<p>The capture of coordinates uses the <code class="docutils literal notranslate"><span class="pre">Git.get_url_and_commit()</span></code> method, that by default does:</p>
<ul class="simple">
<li><p>If the repository is dirty, it will raise an exception</p></li>
<li><p>If the repository is not dirty, but the commit doesn‚Äôt exist in the remote, it will warn, but it will return the local folder as repo <code class="docutils literal notranslate"><span class="pre">url</span></code>.
This way, local commits can be tested without needing to push them to the server. The <code class="docutils literal notranslate"><span class="pre">core.scm:local_url=allow</span></code> can silence
the warning and the <code class="docutils literal notranslate"><span class="pre">core.scm:local_url=block</span></code> will immediately raise an error: This last value can be useful for CI
scenarios, to fail fast and save a build that would have been blocked later in the <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">upload</span></code>.</p></li>
<li><p>Packages built with local commit will fail if trying to upload them to the server with <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">upload</span></code> as those local commits
are not in the server and then the package might not be reproducible. This upload error can be avoided by setting <code class="docutils literal notranslate"><span class="pre">core.scm:local_url=allow</span></code>.</p></li>
<li><p>If the repository is not dirty, and the commit exists in the server, it will return the remote URL and the commit.</p></li>
</ul>
<section id="credentials-management">
<h2>Credentials management<a class="headerlink" href="#credentials-management" title="Link to this heading">¬∂</a></h2>
<p>In the example above, credentials were not necessary, because our local repo didn‚Äôt require them. But in real world scenarios, the credentials can be required.</p>
<p>The first important bit is that <code class="docutils literal notranslate"><span class="pre">git.get_url_and_commit()</span></code> will capture the url of the <code class="docutils literal notranslate"><span class="pre">origin</span></code> remote. This url must not encode tokens, users or passwords, for several reasons. First because that will make the process not repeatable, and different builds, different users would get different urls, and consequently different recipe revisions. The <code class="docutils literal notranslate"><span class="pre">url</span></code> should always be the same. The recommended approach is to manage the credentials in an orthogonal way, for example using ssh keys. The provided example contains a Github action that does this:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">.github/workflows/hello-demo.yml</span><a class="headerlink" href="#id2" title="Link to this code">¬∂</a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build &quot;hello&quot; package capturing SCM in Github actions</span>
<span class="nt">run-name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ github.actor }} checking hello-ci Git scm capture</span>
<span class="nt">on</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">push</span><span class="p p-Indicator">]</span>
<span class="nt">jobs</span><span class="p">:</span>
<span class="nt">Build</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Check out repository code</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">uses</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v3</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">with</span><span class="p p-Indicator">:</span>
<span class="w">        </span><span class="nt">ssh-key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.SSH_PRIVATE_KEY }}</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/setup-python@v4</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">with</span><span class="p p-Indicator">:</span>
<span class="w">        </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.10&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">webfactory/ssh-agent@v0.7.0</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">with</span><span class="p p-Indicator">:</span>
<span class="w">        </span><span class="nt">ssh-private-key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.SSH_PRIVATE_KEY }}</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pip install conan</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">conan profile detect</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">conan create .</span>
</pre></div>
</div>
</div>
<p>This <code class="docutils literal notranslate"><span class="pre">hello-demo.yml</span></code> takes care of the following:</p>
<ul class="simple">
<li><p>The checkout <code class="docutils literal notranslate"><span class="pre">actions/checkout&#64;v3</span></code> action receives the <code class="docutils literal notranslate"><span class="pre">ssh-key</span></code> to checkout as <code class="docutils literal notranslate"><span class="pre">git&#64;</span></code> instead of <code class="docutils literal notranslate"><span class="pre">https</span></code></p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">webfactory/ssh-agent&#64;v0.7.0</span></code> action takes care that the ssh key is also activated during the execution of the following tasks, not only during the checkout.</p></li>
<li><p>It is necessary to setup the <code class="docutils literal notranslate"><span class="pre">SSH_PRIVATE_KEY</span></code> secret in the Github interface, as well as the <code class="docutils literal notranslate"><span class="pre">deploy</span> <span class="pre">key</span></code> for the repo (with the private and public parts of the ssh-key)</p></li>
</ul>
<p>In this way, it is possible to keep completely separated the authentication and credentials from the recipe functionality, without any risk to leaking credentials.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Best practices</strong></p>
<ul class="simple">
<li><p>Do not use an authentication mechanism that encodes information in the urls. This is risky, can easily disclose credentials in logs. It is recommended to use system mechanisms like ssh keys.</p></li>
<li><p>Doing <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">create</span></code> is not recommended for local development, but instead running <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">install</span></code> and building locally, to avoid too many unnecessary commits. Only when everything works locally, it is time to start checking the <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">create</span></code> flow.</p></li>
</ul>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../../../autotools/create_your_first_package_windows.html" class="btn btn-neutral float-left" title="Create your first Conan package with Autotools in Windows (msys2)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../../microsoft/msbuild.html" class="btn btn-neutral float-right" title="MSBuild" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2024, JFrog.
      <span class="lastupdated">Last updated on Feb 25, 2026.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    Version: 2.7
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
    <dt>Versions</dt>
    
        
            <dd><a href="/2.26/index.html">2.26</a></dd>
        
    
        
            <dd><a href="/2.25/index.html">2.25</a></dd>
        
    
        
            <dd><a href="/2.24/index.html">2.24</a></dd>
        
    
        
            <dd><a href="/2.23/index.html">2.23</a></dd>
        
    
        
            <dd><a href="/2.22/index.html">2.22</a></dd>
        
    
        
            <dd><a href="/2.21/index.html">2.21</a></dd>
        
    
        
            <dd><a href="/2.20/index.html">2.20</a></dd>
        
    
        
            <dd><a href="/2.19/index.html">2.19</a></dd>
        
    
        
            <dd><a href="/2.18/index.html">2.18</a></dd>
        
    
        
            <dd><a href="/2.17/index.html">2.17</a></dd>
        
    
        
            <dd><a href="/2.16/index.html">2.16</a></dd>
        
    
        
            <dd><a href="/2.15/index.html">2.15</a></dd>
        
    
        
            <dd><a href="/2.14/index.html">2.14</a></dd>
        
    
        
            <dd><a href="/2.13/index.html">2.13</a></dd>
        
    
        
            <dd><a href="/2.12/index.html">2.12</a></dd>
        
    
        
            <dd><a href="/2.11/index.html">2.11</a></dd>
        
    
        
            <dd><a href="/2.10/index.html">2.10</a></dd>
        
    
        
            <dd><a href="/2.9/index.html">2.9</a></dd>
        
    
        
            <dd><a href="/2.8/index.html">2.8</a></dd>
        
    
        
            <dd><a href="/2.7/index.html">2.7</a></dd>
        
    
        
            <dd><a href="/2.6/index.html">2.6</a></dd>
        
    
        
            <dd><a href="/2.5/index.html">2.5</a></dd>
        
    
        
            <dd><a href="/2.4/index.html">2.4</a></dd>
        
    
        
            <dd><a href="/2.3/index.html">2.3</a></dd>
        
    
        
            <dd><a href="/2.2/index.html">2.2</a></dd>
        
    
        
            <dd><a href="/2.1/index.html">2.1</a></dd>
        
    
        
            <dd><a href="/2.0/index.html">2.0</a></dd>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
            <dd><a href="/2/index.html">2</a></dd>
        
    
    <br>
        <details>
            <summary>Conan 1 releases</summary>
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
            <dd><a href="/1/index.html">1</a></dd>
        
    
        
            <dd><a href="/en/1.66/index.html">1.66</a></dd>
        
    
        
            <dd><a href="/en/1.65/index.html">1.65</a></dd>
        
    
        
            <dd><a href="/en/1.64/index.html">1.64</a></dd>
        
    
        
            <dd><a href="/en/1.63/index.html">1.63</a></dd>
        
    
        
            <dd><a href="/en/1.62/index.html">1.62</a></dd>
        
    
        
            <dd><a href="/en/1.61/index.html">1.61</a></dd>
        
    
        
            <dd><a href="/en/1.60/index.html">1.60</a></dd>
        
    
        
            <dd><a href="/en/1.59/index.html">1.59</a></dd>
        
    
        
            <dd><a href="/en/1.58/index.html">1.58</a></dd>
        
    
        
            <dd><a href="/en/1.57/index.html">1.57</a></dd>
        
    
        
            <dd><a href="/en/1.56/index.html">1.56</a></dd>
        
    
        
            <dd><a href="/en/1.55/index.html">1.55</a></dd>
        
    
        
            <dd><a href="/en/1.54/index.html">1.54</a></dd>
        
    
        
            <dd><a href="/en/1.53/index.html">1.53</a></dd>
        
    
        
            <dd><a href="/en/1.52/index.html">1.52</a></dd>
        
    
        
            <dd><a href="/en/1.51/index.html">1.51</a></dd>
        
    
        
            <dd><a href="/en/1.50/index.html">1.50</a></dd>
        
    
        
            <dd><a href="/en/1.49/index.html">1.49</a></dd>
        
    
        
            <dd><a href="/en/1.48/index.html">1.48</a></dd>
        
    
        
            <dd><a href="/en/1.47/index.html">1.47</a></dd>
        
    
        
            <dd><a href="/en/1.46/index.html">1.46</a></dd>
        
    
        
            <dd><a href="/en/1.45/index.html">1.45</a></dd>
        
    
        
            <dd><a href="/en/1.44/index.html">1.44</a></dd>
        
    
        
            <dd><a href="/en/1.43/index.html">1.43</a></dd>
        
    
        
            <dd><a href="/en/1.42/index.html">1.42</a></dd>
        
    
        
            <dd><a href="/en/1.41/index.html">1.41</a></dd>
        
    
        
            <dd><a href="/en/1.40/index.html">1.40</a></dd>
        
    
        
            <dd><a href="/en/1.39/index.html">1.39</a></dd>
        
    
        
            <dd><a href="/en/1.38/index.html">1.38</a></dd>
        
    
        
            <dd><a href="/en/1.37/index.html">1.37</a></dd>
        
    
        
            <dd><a href="/en/1.36/index.html">1.36</a></dd>
        
    
        
            <dd><a href="/en/1.35/index.html">1.35</a></dd>
        
    
        
            <dd><a href="/en/1.34/index.html">1.34</a></dd>
        
    
        
            <dd><a href="/en/1.33/index.html">1.33</a></dd>
        
    
        
            <dd><a href="/en/1.32/index.html">1.32</a></dd>
        
    
        
            <dd><a href="/en/1.31/index.html">1.31</a></dd>
        
    
        
            <dd><a href="/en/1.30/index.html">1.30</a></dd>
        
    
        
            <dd><a href="/en/1.29/index.html">1.29</a></dd>
        
    
        
            <dd><a href="/en/1.28/index.html">1.28</a></dd>
        
    
        
            <dd><a href="/en/1.27/index.html">1.27</a></dd>
        
    
        
            <dd><a href="/en/1.26/index.html">1.26</a></dd>
        
    
        
            <dd><a href="/en/1.25/index.html">1.25</a></dd>
        
    
        
            <dd><a href="/en/1.24/index.html">1.24</a></dd>
        
    
        
            <dd><a href="/en/1.23/index.html">1.23</a></dd>
        
    
        
            <dd><a href="/en/1.22/index.html">1.22</a></dd>
        
    
        
            <dd><a href="/en/1.21/index.html">1.21</a></dd>
        
    
        
            <dd><a href="/en/1.20/index.html">1.20</a></dd>
        
    
        
            <dd><a href="/en/1.19/index.html">1.19</a></dd>
        
    
        
            <dd><a href="/en/1.18/index.html">1.18</a></dd>
        
    
        
            <dd><a href="/en/1.17/index.html">1.17</a></dd>
        
    
        
            <dd><a href="/en/1.16/index.html">1.16</a></dd>
        
    
        
            <dd><a href="/en/1.15/index.html">1.15</a></dd>
        
    
        
            <dd><a href="/en/1.14/index.html">1.14</a></dd>
        
    
        
            <dd><a href="/en/1.13/index.html">1.13</a></dd>
        
    
        
            <dd><a href="/en/1.12/index.html">1.12</a></dd>
        
    
        
            <dd><a href="/en/1.11/index.html">1.11</a></dd>
        
    
        
            <dd><a href="/en/1.10/index.html">1.10</a></dd>
        
    
        
            <dd><a href="/en/1.9/index.html">1.9</a></dd>
        
    
        
            <dd><a href="/en/1.8/index.html">1.8</a></dd>
        
    
        
            <dd><a href="/en/1.7/index.html">1.7</a></dd>
        
    
        
            <dd><a href="/en/1.6/index.html">1.6</a></dd>
        
    
        
            <dd><a href="/en/1.5/index.html">1.5</a></dd>
        
    
        
            <dd><a href="/en/1.4/index.html">1.4</a></dd>
        
    
        
            <dd><a href="/en/1.3/index.html">1.3</a></dd>
        
    
        
    
        </details>
    </dl>
    <dl>
        <dt>Downloads</dt>
        
            <dd><a href="/2.7/conan.pdf">PDF</a></dd>
        
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

<noscript><iframe src="https://gtm.jfrog.com/ns.html?id=GTM-WK44ZFM" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>


 


</body>
</html>