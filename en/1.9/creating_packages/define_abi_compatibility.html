



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Defining Package ABI Compatibility &mdash; conan 1.9.2 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  


  
    <link rel="stylesheet" href="../_static/css/signup.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/css/select2.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="../_static/css/search.css" type="text/css" />
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="conan 1.9.2 documentation" href="../index.html"/>
        <link rel="up" title="Creating Packages" href="../creating_packages.html"/>
        <link rel="next" title="Inspecting Packages" href="inspecting_packages.html"/>
        <link rel="prev" title="Understanding Packaging" href="understand_packaging.html"/>

 <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-WK44ZFM');</script>
<!-- End Google Tag Manager -->
 
<!-- Global site tag (gtag.js) - Google Analytics -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=GTM-WK44ZFM"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'GTM-WK44ZFM');
</script>


</script>


  

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="https://conan.io">
          

          
            
            <img src="../_static/conan_logo.png" class="logo" />
          
          </a>

            

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_packages.html">Using packages</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../creating_packages.html">Creating Packages</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="external_repo.html">Recipe and Sources in a Different Repo</a></li>
<li class="toctree-l2"><a class="reference internal" href="package_repo.html">Recipe and Sources in the Same Repo</a></li>
<li class="toctree-l2"><a class="reference internal" href="existing_binaries.html">Packaging Existing Binaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="understand_packaging.html">Understanding Packaging</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Defining Package ABI Compatibility</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#defining-a-custom-package-id">Defining a Custom package_id()</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dependency-issues">Dependency Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-package-id-for-package-dependencies">Using package_id() for Package Dependencies</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#versioning-schema">Versioning Schema</a></li>
<li class="toctree-l4"><a class="reference internal" href="#library-types-shared-static-header-only">Library Types: Shared, Static, Header-only</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="inspecting_packages.html">Inspecting Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="package_approaches.html">Packaging Approaches</a></li>
<li class="toctree-l2"><a class="reference internal" href="package_tools.html">Package Creator Tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../uploading_packages.html">Uploading Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developing_packages.html">Developing Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devtools.html">Package apps and devtools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mastering.html">Mastering Conan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../systems_cross_building.html">Systems and cross building</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extending.html">Extending Conan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../integrations.html">Integrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../howtos.html">Howtos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../videos.html">Videos and links</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>

            
          
          <div class="dark_newsletter-div">
             <p>Sign up for release updates:</p>
              <script src="https://app-lon04.marketo.com/js/forms2/js/forms2.min.js"></script>
              <form id="mktoForm_1479"></form>
              <script>MktoForms2.loadForm("https://app-lon04.marketo.com", "256-FNZ-187", 1479);</script>
          </div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">conan</a>
        
      </nav>


      
      <script>
        var reldir = "../index.html".replace("index.html","").replace("#", "");
      </script>
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation" id="breadcrumbs">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../creating_packages.html">Creating Packages</a> &raquo;</li>
        
      <li>Defining Package ABI Compatibility</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/conan-io/docs/blob/master/creating_packages/define_abi_compatibility.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
</div>
          <!--<select id="search" name="state" multiple="true" onchange="window.location = reldir + this.value;" style="width:90%"></select>
          <hr/>-->

          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="defining-package-abi-compatibility">
<span id="define-abi-compatibility"></span><h1>Defining Package ABI Compatibility<a class="headerlink" href="#defining-package-abi-compatibility" title="Permalink to this headline">Â¶</a></h1>
<p>Each package recipe can generate <em>N</em> binary packages from it, depending on these three items:
<code class="docutils literal notranslate"><span class="pre">settings</span></code>, <code class="docutils literal notranslate"><span class="pre">options</span></code> and <code class="docutils literal notranslate"><span class="pre">requires</span></code>.</p>
<p>When any of the <a class="reference internal" href="../reference/conanfile/attributes.html#settings-property"><span class="std std-ref">settings</span></a> of a package recipe changes, it will reference a
different binary:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyLibConanPackage</span><span class="p">(</span><span class="n">ConanFile</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;MyLib&quot;</span>
    <span class="n">version</span> <span class="o">=</span> <span class="s2">&quot;1.0&quot;</span>
    <span class="n">settings</span> <span class="o">=</span> <span class="s2">&quot;os&quot;</span><span class="p">,</span> <span class="s2">&quot;arch&quot;</span><span class="p">,</span> <span class="s2">&quot;compiler&quot;</span><span class="p">,</span> <span class="s2">&quot;build_type&quot;</span>
</pre></div>
</div>
<p>When this package is installed by a <em>conanfile.txt</em>, another package <em>conanfile.py</em>, or directly:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ conan install MyLib/1.0@user/channel -s <span class="nv">arch</span><span class="o">=</span>x86_64 -s ...
</pre></div>
</div>
<p>The process is:</p>
<ol class="arabic simple">
<li>Conan gets the user input settings and options. Those settings and options can come from the command line, profiles or from the values
cached in the latest <strong class="command">conan install</strong> execution.</li>
<li>Conan retrieves the <code class="docutils literal notranslate"><span class="pre">MyLib/1.0&#64;user/channel</span></code> recipe, reads the <code class="docutils literal notranslate"><span class="pre">settings</span></code> attribute, and assigns the necessary values.</li>
<li>With the current package values for <code class="docutils literal notranslate"><span class="pre">settings</span></code> (also <code class="docutils literal notranslate"><span class="pre">options</span></code> and <code class="docutils literal notranslate"><span class="pre">requires</span></code>), it will compute a SHA1 hash that will serve as the binary
package ID, e.g., <code class="docutils literal notranslate"><span class="pre">c6d75a933080ca17eb7f076813e7fb21aaa740f2</span></code>.</li>
<li>Conan will try to find the <code class="docutils literal notranslate"><span class="pre">c6d75...</span></code> binary package. If it exists, it will be retrieved. If it cannot be found, it will fail and indicate that it
can be built from sources using <strong class="command">conan install --build</strong>.</li>
</ol>
<p>If the package is installed again using different settings, for example, on a 32-bit architecture:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ conan install MyLib/1.0@user/channel -s <span class="nv">arch</span><span class="o">=</span>x86 -s ...
</pre></div>
</div>
<p>The process will be repeated with a different generated package ID, because the <code class="docutils literal notranslate"><span class="pre">arch</span></code>
setting will have a different value. The same applies to different compilers, compiler versions, build types. When generating multiple
binaries - a separate ID is generated for each configuration.</p>
<p>When developers using the package use the same settings as one of those uploaded binaries, the computed package ID will be
identical causing the binary to be retrieved and reused without the need of rebuilding it from the sources.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">options</span></code> behavior is very similar. The main difference is that <code class="docutils literal notranslate"><span class="pre">options</span></code> can be more easily defined at the package level and they can
be defaulted. Check the <a class="reference internal" href="../reference/conanfile/attributes.html#conanfile-options"><span class="std std-ref">options</span></a> reference.</p>
<p>Note this simple scenario of a <strong>header-only</strong> library. The package does not need to be built, and it will not have any ABI issues at all.
The recipe for such a package will be to generate a single binary package, no more. This is easily achieved by not declaring
<code class="docutils literal notranslate"><span class="pre">settings</span></code> nor <code class="docutils literal notranslate"><span class="pre">options</span></code> in the recipe as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyLibConanPackage</span><span class="p">(</span><span class="n">ConanFile</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;MyLib&quot;</span>
    <span class="n">version</span> <span class="o">=</span> <span class="s2">&quot;1.0&quot;</span>
    <span class="c1"># no settings defined!</span>
</pre></div>
</div>
<p>No matter the settings are defined by the users, including the compiler or version, the package settings and options will always be the same
(left empty) and they will hash to the same binary package ID. That package will typically contain just the header files.</p>
<p>What happens if we have a library that we can be built with GCC 4.8 and will preserve the ABI compatibility with GCC 4.9?
(This kind of compatibility is easier to achieve for example for pure C libraries).</p>
<p>Although it could be argued that it is worth rebuilding with 4.9 too -to get fixes and performance improvements-. Letâs suppose
that we donât want to create 2 different binaries, but just a single built with GCC 4.8 which also needs to be compatible for GCC 4.9 installations.</p>
<div class="section" id="defining-a-custom-package-id">
<span id="define-custom-package-id"></span><h2>Defining a Custom package_id()<a class="headerlink" href="#defining-a-custom-package-id" title="Permalink to this headline">Â¶</a></h2>
<p>The default <code class="docutils literal notranslate"><span class="pre">package_id()</span></code> uses the <code class="docutils literal notranslate"><span class="pre">settings</span></code> and <code class="docutils literal notranslate"><span class="pre">options</span></code> directly as defined, and assumes the
<a class="reference external" href="https://semver.org/">semantic versioning</a> for dependencies is defined in <code class="docutils literal notranslate"><span class="pre">requires</span></code>.</p>
<p>This <code class="docutils literal notranslate"><span class="pre">package_id()</span></code> method can be overridden to control the package ID generation. Within the <code class="docutils literal notranslate"><span class="pre">package_id()</span></code>, we have access to the
<code class="docutils literal notranslate"><span class="pre">self.info</span></code> object, which is hashed to compute the binary ID and contains:</p>
<ul class="simple">
<li><strong>self.info.settings</strong>: Contains all the declared settings, always as string values. We can access/modify the settings, e.g.,
<code class="docutils literal notranslate"><span class="pre">self.info.settings.compiler.version</span></code>.</li>
<li><strong>self.info.options</strong>: Contains all the declared options, always as string values too, e.g., <code class="docutils literal notranslate"><span class="pre">self.info.options.shared</span></code>.</li>
</ul>
<p>Initially this <code class="docutils literal notranslate"><span class="pre">info</span></code> object contains the original settings and options, but they can be changed without constraints to any other
string value.</p>
<p>For example, if you are sure your package ABI compatibility is fine for GCC versions &gt; 4.5 and &lt; 5.0, you could do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">conans</span> <span class="kn">import</span> <span class="n">ConanFile</span><span class="p">,</span> <span class="n">CMake</span><span class="p">,</span> <span class="n">tools</span>
<span class="kn">from</span> <span class="nn">conans.model.version</span> <span class="kn">import</span> <span class="n">Version</span>

<span class="k">class</span> <span class="nc">PkgConan</span><span class="p">(</span><span class="n">ConanFile</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Pkg&quot;</span>
    <span class="n">version</span> <span class="o">=</span> <span class="s2">&quot;1.0&quot;</span>
    <span class="n">settings</span> <span class="o">=</span> <span class="s2">&quot;compiler&quot;</span><span class="p">,</span> <span class="s2">&quot;build_type&quot;</span>

    <span class="k">def</span> <span class="nf">package_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">Version</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">compiler</span><span class="o">.</span><span class="n">version</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">compiler</span> <span class="o">==</span> <span class="s2">&quot;gcc&quot;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">v</span> <span class="o">&gt;=</span> <span class="s2">&quot;4.5&quot;</span> <span class="ow">and</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="s2">&quot;5.0&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">compiler</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="s2">&quot;GCC version between 4.5 and 5.0&quot;</span>
</pre></div>
</div>
<p>We have set the <code class="docutils literal notranslate"><span class="pre">self.info.settings.compiler.version</span></code> with an arbitrary string, the value of which is not important (could be any string). The
only important thing is that it is the same for any GCC version between 4.5 and 5.0. For all those versions, the compiler version will
always be hashed to the same ID.</p>
<p>Letâs try and check that it works properly when installing the package for GCC 4.5:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ conan <span class="nb">export</span> myuser/mychannel
$ conan install Pkg/1.0@myuser/mychannel -s <span class="nv">compiler</span><span class="o">=</span>gcc -s compiler.version<span class="o">=</span><span class="m">4</span>.5 ...

Requirements
    Pkg/1.0@myuser/mychannel from <span class="nb">local</span>
Packages
    Pkg/1.0@myuser/mychannel:mychannel:af044f9619574eceb8e1cca737a64bdad88246ad
...
</pre></div>
</div>
<p>We can see that the computed package ID is <code class="docutils literal notranslate"><span class="pre">af04...46ad</span></code> (not real). What happens if we specify GCC 4.6?</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ conan install Pkg/1.0@myuser/mychannel -s <span class="nv">compiler</span><span class="o">=</span>gcc -s compiler.version<span class="o">=</span><span class="m">4</span>.6 ...

Requirements
    Pkg/1.0@myuser/mychannel from <span class="nb">local</span>
Packages
    Pkg/1.0@myuser/mychannel:mychannel:af044f9619574eceb8e1cca737a64bdad88246ad
</pre></div>
</div>
<p>The required package has the same result again <code class="docutils literal notranslate"><span class="pre">af04...46ad</span></code>. Now we can try using GCC 4.4 (&lt; 4.5):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ conan install Pkg/1.0@myuser/mychannel -s <span class="nv">compiler</span><span class="o">=</span>gcc -s compiler.version<span class="o">=</span><span class="m">4</span>.4 ...

Requirements
    Pkg/1.0@myuser/mychannel from <span class="nb">local</span>
Packages
    Pkg/1.0@myuser/mychannel:mychannel:7d02dc01581029782b59dcc8c9783a73ab3c22dd
</pre></div>
</div>
<p>The computed package ID is different which means that we need a different binary package for GCC 4.4.</p>
<p>The same way we have adjusted the <code class="docutils literal notranslate"><span class="pre">self.info.settings</span></code>, we could set the <code class="docutils literal notranslate"><span class="pre">self.info.options</span></code> values if needed.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p>Check <a class="reference internal" href="../reference/conanfile/methods.html#method-package-id"><span class="std std-ref">package_id()</span></a> to see the available helper methods and change its behavior for things like:</p>
<blockquote class="last">
<div><ul class="simple">
<li>Recipes packaging <strong>header only</strong> libraries.</li>
<li>Adjusting <strong>Visual Studio toolsets</strong> compatibility.</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="dependency-issues">
<span id="problem-of-dependencies"></span><h2>Dependency Issues<a class="headerlink" href="#dependency-issues" title="Permalink to this headline">Â¶</a></h2>
<p>Letâs define a simple scenario whereby there are two packages: <code class="docutils literal notranslate"><span class="pre">MyOtherLib/2.0</span></code> and <code class="docutils literal notranslate"><span class="pre">MyLib/1.0</span></code> which depends on
<code class="docutils literal notranslate"><span class="pre">MyOtherLib/2.0</span></code>. Letâs assume that their recipes and binaries have already been created and uploaded to a Conan remote.</p>
<p>Now, a new release for <code class="docutils literal notranslate"><span class="pre">MyOtherLib/2.1</span></code> is released with an improved recipe and new binaries. The <code class="docutils literal notranslate"><span class="pre">MyLib/1.0</span></code> is modified and is required to be upgraded to <code class="docutils literal notranslate"><span class="pre">MyOtherLib/2.1</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This scenario will be the same in the case that a consuming project of <code class="docutils literal notranslate"><span class="pre">MyLib/1.0</span></code> defines a dependency to <code class="docutils literal notranslate"><span class="pre">MyOtherLib/2.1</span></code>, which
takes precedence over the existing project in <code class="docutils literal notranslate"><span class="pre">MyLib/1.0</span></code>.</p>
</div>
<p>The question is: <strong>Is it necessary to build new MyLib/1.0 binary packages?</strong> or are the existing packages still valid?</p>
<p>The answer: <strong>It depends</strong>.</p>
<p>Letâs assume that both packages are compiled as static libraries and that the API exposed by <code class="docutils literal notranslate"><span class="pre">MyOtherLib</span></code> to <code class="docutils literal notranslate"><span class="pre">MyLib/1.0</span></code> through the
public headers, has not changed at all. In this case, it is not required to build new binaries for <code class="docutils literal notranslate"><span class="pre">MyLib/1.0</span></code> because the final consumer will
link against both <code class="docutils literal notranslate"><span class="pre">Mylib/1.0</span></code> and <code class="docutils literal notranslate"><span class="pre">MyOtherLib/2.1</span></code>.</p>
<p>On the other hand, it could happen that the API exposed by <strong>MyOtherLib</strong> in the public headers has changed, but without affecting the
<code class="docutils literal notranslate"><span class="pre">MyLib/1.0</span></code> binary for any reason (like changes consisting on new functions not used by <strong>MyLib</strong>). The same reasoning would apply if <strong>MyOtherLib</strong> was only the header.</p>
<p>But what if a header file of <code class="docutils literal notranslate"><span class="pre">MyOtherLib</span></code> -named <em>myadd.h</em>- has changed from <code class="docutils literal notranslate"><span class="pre">2.0</span></code> to <code class="docutils literal notranslate"><span class="pre">2.1</span></code>:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text"><em>myadd.h</em> header file in version 2.0</span><a class="headerlink" href="#id1" title="Permalink to this code">Â¶</a></div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span> <span class="kt">int</span> <span class="nf">addition</span> <span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">;</span> <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text"><em>myadd.h</em> header file in version 2.1</span><a class="headerlink" href="#id2" title="Permalink to this code">Â¶</a></div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span> <span class="kt">int</span> <span class="nf">addition</span> <span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">;</span> <span class="p">}</span>
</pre></div>
</div>
</div>
<p>And the <code class="docutils literal notranslate"><span class="pre">addition()</span></code> function is called from the compiled <em>.cpp</em> files of <code class="docutils literal notranslate"><span class="pre">MyLib/1.0</span></code>?</p>
<p>Then, <strong>a new binary for MyLib/1.0 is required to be built for the new dependency version</strong>. Otherwise it will maintain the old, buggy
<code class="docutils literal notranslate"><span class="pre">addition()</span></code> version. Even in the case that <code class="docutils literal notranslate"><span class="pre">MyLib/1.0</span></code> doesnât have any change in its code lines neither in the recipe, the resulting
binary rebuilding <code class="docutils literal notranslate"><span class="pre">MyLib</span></code> requires <cite>MyOtherLib/2.1`</cite> and the package to be different.</p>
</div>
<div class="section" id="using-package-id-for-package-dependencies">
<h2>Using package_id() for Package Dependencies<a class="headerlink" href="#using-package-id-for-package-dependencies" title="Permalink to this headline">Â¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">self.info</span></code> object has also a <code class="docutils literal notranslate"><span class="pre">requires</span></code> object. It is a dictionary containing the necessary information for each requirement, all direct
and transitive dependencies. For example, <code class="docutils literal notranslate"><span class="pre">self.info.requires[&quot;MyOtherLib&quot;]</span></code> is a <code class="docutils literal notranslate"><span class="pre">RequirementInfo</span></code> object.</p>
<ul>
<li><p class="first">Each <code class="docutils literal notranslate"><span class="pre">RequirementInfo</span></code> has the following <cite>read only</cite> reference fields:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">full_name</span></code>: Full requireâs name, e.g., <strong>MyOtherLib</strong></li>
<li><code class="docutils literal notranslate"><span class="pre">full_version</span></code>: Full requireâs version, e.g., <strong>1.2</strong></li>
<li><code class="docutils literal notranslate"><span class="pre">full_user</span></code>: Full requireâs user, e.g., <strong>my_user</strong></li>
<li><code class="docutils literal notranslate"><span class="pre">full_channel</span></code>: Full requireâs channel, e.g., <strong>stable</strong></li>
<li><code class="docutils literal notranslate"><span class="pre">full_package_id</span></code>: Full requireâs package ID, e.g., <strong>c6d75aâ¦</strong></li>
</ul>
</div></blockquote>
</li>
<li><p class="first">The following fields are used in the <code class="docutils literal notranslate"><span class="pre">package_id()</span></code> evaluation:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">name</span></code>: By default same value as full_name, e.g., <strong>MyOtherLib</strong>.</li>
<li><code class="docutils literal notranslate"><span class="pre">version</span></code>: By default the major version representation of the <code class="docutils literal notranslate"><span class="pre">full_version</span></code>.
E.g., <strong>1.Y</strong> for a <strong>1.2</strong> <code class="docutils literal notranslate"><span class="pre">full_version</span></code> field and <strong>1.Y.Z</strong> for a <strong>1.2.3</strong>
<code class="docutils literal notranslate"><span class="pre">full_version</span></code> field.</li>
<li><code class="docutils literal notranslate"><span class="pre">user</span></code>: By default <code class="docutils literal notranslate"><span class="pre">None</span></code> (doesnât affect the package ID).</li>
<li><code class="docutils literal notranslate"><span class="pre">channel</span></code>: By default <code class="docutils literal notranslate"><span class="pre">None</span></code> (doesnât affect the package ID).</li>
<li><code class="docutils literal notranslate"><span class="pre">package_id</span></code>: By default <code class="docutils literal notranslate"><span class="pre">None</span></code> (doesnât affect the package ID).</li>
</ul>
</div></blockquote>
</li>
</ul>
<p>When defining a package ID for model dependencies, it is necessary to take into account two factors:</p>
<ul class="simple">
<li>The versioning schema followed by our requirements (semver?, custom?).</li>
<li>The type of library being built or reused (shared (<em>.so</em>, <em>.dll</em>, <em>.dylib</em>), static).</li>
</ul>
<div class="section" id="versioning-schema">
<h3>Versioning Schema<a class="headerlink" href="#versioning-schema" title="Permalink to this headline">Â¶</a></h3>
<p>By default Conan assumes <a class="reference external" href="https://semver.org/">semver</a> compatibility. For example, if a version changes from minor <strong>2.0</strong> to <strong>2.1</strong>, Conan will
assume that the API is compatible (headers not changing), and that it is not necessary to build a new binary for it. This also applies to
patches, whereby changing from <strong>2.1.10</strong> to <strong>2.1.11</strong> doesnât require a re-build.</p>
<p>If it is necessary to change the default behavior, the applied versioning schema can be customized within the <code class="docutils literal notranslate"><span class="pre">package_id()</span></code> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">conans</span> <span class="kn">import</span> <span class="n">ConanFile</span><span class="p">,</span> <span class="n">CMake</span><span class="p">,</span> <span class="n">tools</span>
<span class="kn">from</span> <span class="nn">conans.model.version</span> <span class="kn">import</span> <span class="n">Version</span>

<span class="k">class</span> <span class="nc">PkgConan</span><span class="p">(</span><span class="n">ConanFile</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Mylib&quot;</span>
    <span class="n">version</span> <span class="o">=</span> <span class="s2">&quot;1.0&quot;</span>
    <span class="n">settings</span> <span class="o">=</span> <span class="s2">&quot;os&quot;</span><span class="p">,</span> <span class="s2">&quot;compiler&quot;</span><span class="p">,</span> <span class="s2">&quot;build_type&quot;</span><span class="p">,</span> <span class="s2">&quot;arch&quot;</span>
    <span class="n">requires</span> <span class="o">=</span> <span class="s2">&quot;MyOtherLib/2.0@lasote/stable&quot;</span>

    <span class="k">def</span> <span class="nf">package_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">myotherlib</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">requires</span><span class="p">[</span><span class="s2">&quot;MyOtherLib&quot;</span><span class="p">]</span>

        <span class="c1"># Any change in the MyOtherLib version will change current Package ID</span>
        <span class="n">myotherlib</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">myotherlib</span><span class="o">.</span><span class="n">full_version</span>

        <span class="c1"># Changes in major and minor versions will change the Package ID but</span>
        <span class="c1"># only a MyOtherLib patch won&#39;t. E.g., from 1.2.3 to 1.2.89 won&#39;t change.</span>
        <span class="n">myotherlib</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">myotherlib</span><span class="o">.</span><span class="n">full_version</span><span class="o">.</span><span class="n">minor</span><span class="p">()</span>
</pre></div>
</div>
<p>Besides <code class="docutils literal notranslate"><span class="pre">version</span></code>, there are additional helpers that can be used to determine whether the <strong>channel</strong> and <strong>user</strong> of one dependency also
affects the binary package, or even the required package ID can change your own package ID.</p>
<p>You can determine if the following variables within any requirement change the ID of your binary package using the following modes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="9%" />
<col width="36%" />
<col width="9%" />
<col width="11%" />
<col width="14%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Modes / Variables</strong></th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">name</span></code></th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">version</span></code></th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">user</span></code></th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">channel</span></code></th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">package_id</span></code></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">semver_mode()</span></code></td>
<td>Yes</td>
<td>Yes, only &gt; 1.0.0 (e.g., <strong>1</strong>.2.Z+b102)</td>
<td>No</td>
<td>No</td>
<td>No</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">major_mode()</span></code></td>
<td>Yes</td>
<td>Yes (e.g., <strong>1</strong>.2.Z+b102)</td>
<td>No</td>
<td>No</td>
<td>No</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">minor_mode()</span></code></td>
<td>Yes</td>
<td>Yes (e.g., <strong>1.2</strong>.Z+b102)</td>
<td>No</td>
<td>No</td>
<td>No</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">patch_mode()</span></code></td>
<td>Yes</td>
<td>Yes (e.g., <strong>1.2.3</strong>+b102)</td>
<td>No</td>
<td>No</td>
<td>No</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">base_mode()</span></code></td>
<td>Yes</td>
<td>Yes (e.g., <strong>1.7</strong>+b102)</td>
<td>No</td>
<td>No</td>
<td>No</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">full_version_mode()</span></code></td>
<td>Yes</td>
<td>Yes (e.g., <strong>1.2.3+b102</strong>)</td>
<td>No</td>
<td>No</td>
<td>No</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">full_recipe_mode()</span></code></td>
<td>Yes</td>
<td>Yes (e.g., <strong>1.2.3+b102</strong>)</td>
<td>Yes</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">full_package_mode()</span></code></td>
<td>Yes</td>
<td>Yes (e.g., <strong>1.2.3+b102</strong>)</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">unrelated_mode()</span></code></td>
<td>No</td>
<td>No</td>
<td>No</td>
<td>No</td>
<td>No</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">semver_mode()</span></code>: This is the default mode. In this mode, only a major release version (starting from <strong>1.0.0</strong>) changes the package ID.
Every version change prior to 1.0.0 changes the package ID, but only major changes after 1.0.0 will be applied.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">package_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">requires</span><span class="p">[</span><span class="s2">&quot;MyOtherLib&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">semver_mode</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">major_mode()</span></code>: Any change in the major release version (starting from <strong>0.0.0</strong>) changes the package ID.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">package_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">requires</span><span class="p">[</span><span class="s2">&quot;MyOtherLib&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">major_mode</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">minor_mode()</span></code>: Any change in major or minor (not patch nor build) version of the required dependency changes the package ID.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">package_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">requires</span><span class="p">[</span><span class="s2">&quot;MyOtherLib&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">patch_mode</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">patch_mode()</span></code>: Any changes to major, minor or patch (not build) versions of the required dependency change the package ID.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">package_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">requires</span><span class="p">[</span><span class="s2">&quot;MyOtherLib&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">patch_mode</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">base_mode()</span></code>: Any changes to the base of the version (not build) of the required dependency changes the package ID. Note that in the
case of semver notation this may produce the same result as <code class="docutils literal notranslate"><span class="pre">patch_mode()</span></code>, but it is actually intended to dismiss the build part of the
version even without strict semver.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">package_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">requires</span><span class="p">[</span><span class="s2">&quot;MyOtherLib&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">base_mode</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">full_version_mode()</span></code>: Any changes to the version of the required dependency changes the package ID.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">package_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">requires</span><span class="p">[</span><span class="s2">&quot;MyOtherLib&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">full_version_mode</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">full_recipe_mode()</span></code>: Any change in the reference of the requirement (user &amp; channel too) changes the package ID.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">package_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">requires</span><span class="p">[</span><span class="s2">&quot;MyOtherLib&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">full_recipe_mode</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">full_package_mode()</span></code>: Any change in the required version, user, channel or package ID changes the package ID.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">package_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">requires</span><span class="p">[</span><span class="s2">&quot;MyOtherLib&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">full_package_mode</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">unrelated_mode()</span></code>: Requirements do not change the package ID.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">package_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">requires</span><span class="p">[</span><span class="s2">&quot;MyOtherLib&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unrelated_mode</span><span class="p">()</span>
</pre></div>
</div>
</li>
</ul>
<p>You can also adjust the individual properties manually:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">package_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">myotherlib</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">requires</span><span class="p">[</span><span class="s2">&quot;MyOtherLib&quot;</span><span class="p">]</span>

    <span class="c1"># Same as myotherlib.semver_mode()</span>
    <span class="n">myotherlib</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">myotherlib</span><span class="o">.</span><span class="n">full_name</span>
    <span class="n">myotherlib</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">myotherlib</span><span class="o">.</span><span class="n">full_version</span><span class="o">.</span><span class="n">stable</span><span class="p">()</span>  <span class="c1"># major(), minor(), patch(), base, build</span>
    <span class="n">myotherlib</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">myotherlib</span><span class="o">.</span><span class="n">channel</span> <span class="o">=</span> <span class="n">myotherlib</span><span class="o">.</span><span class="n">package_id</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Only the channel (and the name) matters</span>
    <span class="n">myotherlib</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">myotherlib</span><span class="o">.</span><span class="n">full_name</span>
    <span class="n">myotherlib</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">myotherlib</span><span class="o">.</span><span class="n">package_id</span> <span class="o">=</span> <span class="n">myotherlib</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">myotherlib</span><span class="o">.</span><span class="n">channel</span> <span class="o">=</span> <span class="n">myotherlib</span><span class="o">.</span><span class="n">full_channel</span>
</pre></div>
</div>
<p>The result of the <code class="docutils literal notranslate"><span class="pre">package_id()</span></code> is the package ID hash, but the details can be checked in the
generated <em>conaninfo.txt</em> file. The <code class="docutils literal notranslate"><span class="pre">[requires]</span></code>, <code class="docutils literal notranslate"><span class="pre">[options]</span></code> and <code class="docutils literal notranslate"><span class="pre">[settings]</span></code> are taken
into account when generating the SHA1 hash for the package ID, while the <code class="docutils literal notranslate"><span class="pre">[full_xxxx]</span></code> fields show the
complete reference information.</p>
<p>The default behavior produces a <em>conaninfo.txt</em> that looks like:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[requires]
  MyOtherLib/2.Y.Z

[full_requires]
  MyOtherLib/2.2@demo/testing:73bce3fd7eb82b2eabc19fe11317d37da81afa56
</pre></div>
</div>
</div>
<div class="section" id="library-types-shared-static-header-only">
<h3>Library Types: Shared, Static, Header-only<a class="headerlink" href="#library-types-shared-static-header-only" title="Permalink to this headline">Â¶</a></h3>
<p>Letâs see some examples, corresponding to common scenarios:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">MyLib/1.0</span></code> is a shared library that links with a static library <code class="docutils literal notranslate"><span class="pre">MyOtherLib/2.0</span></code> package.
When a new <code class="docutils literal notranslate"><span class="pre">MyOtherLib/2.1</span></code> version is released: Do I need to create a new binary for
<code class="docutils literal notranslate"><span class="pre">MyLib/1.0</span></code> to link with it?</p>
<p>Yes, always, as the implementation is embedded in the <code class="docutils literal notranslate"><span class="pre">MyLib/1.0</span></code> shared library. If we
always want to rebuild our library, even if the channel changes (we assume a channel change could
mean a source code change):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">package_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Any change in the MyOtherLib version, user or</span>
    <span class="c1"># channel or Package ID will affect our package ID</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">requires</span><span class="p">[</span><span class="s2">&quot;MyOtherLib&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">full_package_mode</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">MyLib/1.0</span></code> is a shared library, requiring another shared library <code class="docutils literal notranslate"><span class="pre">MyOtherLib/2.0</span></code> package.
When a new <code class="docutils literal notranslate"><span class="pre">MyOtherLib/2.1</span></code> version is released: Do I need to create a new binary for
<code class="docutils literal notranslate"><span class="pre">MyLib/1.0</span></code> to link with it?</p>
<p>It depends. If the public headers have not changed at all, it is not necessary. Actually it might
be necessary to consider transitive dependencies that are shared among the public headers, how
they are linked and if they cross the frontiers of the API, it might also lead to
incompatibilities. If the public headers have changed, it would depend on what changes and how are
they used in <code class="docutils literal notranslate"><span class="pre">MyLib/1.0</span></code>. Adding new methods to the public headers will have no impact, but
changing the implementation of some functions that will be inlined when compiled from
<code class="docutils literal notranslate"><span class="pre">MyLib/1.0</span></code> will definitely require re-building. For this case, it could make sense to have this configuration:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">package_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Any change in the MyOtherLib version, user or channel</span>
    <span class="c1"># or Package ID will affect our package ID</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">requires</span><span class="p">[</span><span class="s2">&quot;MyOtherLib&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">full_package_mode</span><span class="p">()</span>

    <span class="c1"># Or any change in the MyOtherLib version, user or</span>
    <span class="c1"># channel will affect our package ID</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">requires</span><span class="p">[</span><span class="s2">&quot;MyOtherLib&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">full_recipe_mode</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">MyLib/1.0</span></code> is a header-only library, linking with any kind (header, static, shared) of library
in <code class="docutils literal notranslate"><span class="pre">MyOtherLib/2.0</span></code> package. When a new <code class="docutils literal notranslate"><span class="pre">MyOtherLib/2.1</span></code> version is released: Do I need to
create a new binary for <code class="docutils literal notranslate"><span class="pre">MyLib/1.0</span></code> to link with it?</p>
<p>Never. The package should always be the same as there are no settings, no options, and in any way a
dependency can affect a binary, because there is no such binary. The default behavior should be
changed to:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">package_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">requires</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">MyLib/1.0</span></code> is a static library linking to a header only library in <code class="docutils literal notranslate"><span class="pre">MyOtherLib/2.0</span></code>
package. When a new <code class="docutils literal notranslate"><span class="pre">MyOtherLib/2.1</span></code> version is released: Do I need to create a new binary for
<code class="docutils literal notranslate"><span class="pre">MyLib/1.0</span></code> to link with it? It could happen that the <code class="docutils literal notranslate"><span class="pre">MyOtherLib</span></code> headers are strictly used
in some <code class="docutils literal notranslate"><span class="pre">MyLib</span></code> headers, which are not compiled, but transitively included. But in general,
it is more likely that <code class="docutils literal notranslate"><span class="pre">MyOtherLib</span></code> headers are used in <code class="docutils literal notranslate"><span class="pre">MyLib</span></code> implementation files, so every
change in them should imply a new binary to be built. If we know that changes in the channel never
imply a source code change, as set in our workflow/lifecycle, we could
write:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">package_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">requires</span><span class="p">[</span><span class="s2">&quot;MyOtherLib&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">full_package</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">requires</span><span class="p">[</span><span class="s2">&quot;MyOtherLib&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">channel</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># Channel doesn&#39;t change out package ID</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="inspecting_packages.html" class="btn btn-neutral float-right" title="Inspecting Packages" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="understand_packaging.html" class="btn btn-neutral" title="Understanding Packaging" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2018, JFrog.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <!--<span class="fa fa-pencil-square-o"> Other versions:</span> -->
      Version: 1.9
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          
            <dd><a href="/en/latest/index.html">1.25</a></dd>
          
        
          
            <dd><a href="/en/1.24/index.html">1.24</a></dd>
          
        
          
            <dd><a href="/en/1.23/index.html">1.23</a></dd>
          
        
          
            <dd><a href="/en/1.22/index.html">1.22</a></dd>
          
        
          
            <dd><a href="/en/1.21/index.html">1.21</a></dd>
          
        
          
            <dd><a href="/en/1.20/index.html">1.20</a></dd>
          
        
          
            <dd><a href="/en/1.19/index.html">1.19</a></dd>
          
        
          
            <dd><a href="/en/1.18/index.html">1.18</a></dd>
          
        
          
            <dd><a href="/en/1.17/index.html">1.17</a></dd>
          
        
          
            <dd><a href="/en/1.16/index.html">1.16</a></dd>
          
        
          
            <dd><a href="/en/1.15/index.html">1.15</a></dd>
          
        
          
            <dd><a href="/en/1.14/index.html">1.14</a></dd>
          
        
          
            <dd><a href="/en/1.13/index.html">1.13</a></dd>
          
        
          
            <dd><a href="/en/1.12/index.html">1.12</a></dd>
          
        
          
            <dd><a href="/en/1.11/index.html">1.11</a></dd>
          
        
          
            <dd><a href="/en/1.10/index.html">1.10</a></dd>
          
        
          
            <dd><a href="/en/1.9/index.html">1.9</a></dd>
          
        
          
            <dd><a href="/en/1.8/index.html">1.8</a></dd>
          
        
          
            <dd><a href="/en/1.7/index.html">1.7</a></dd>
          
        
          
            <dd><a href="/en/1.6/index.html">1.6</a></dd>
          
        
          
            <dd><a href="/en/1.5/index.html">1.5</a></dd>
          
        
          
            <dd><a href="/en/1.4/index.html">1.4</a></dd>
          
        
          
            <dd><a href="/en/1.3/index.html">1.3</a></dd>
          
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
          <dd><a href="/en/1.9/conan.pdf">PDF</a></dd>
        
      </dl>
    </div>
  </div>

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.9.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  <!-- <script
  src="https://code.jquery.com/jquery-3.4.1.min.js"
  integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
  crossorigin="anonymous"></script>
  <script src="../_static/js/modernizr.min.js"></script>
  <script src="../_static/js/search.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/js/select2.min.js"></script>
-->
  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  


  <script>
    // initSearch("1.9");
  </script>

<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WK44ZFM" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>


 


</body>
</html>