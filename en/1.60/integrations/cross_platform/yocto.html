<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Yocto &mdash; conan 1.60.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
    <link rel="shortcut icon" href="../../_static/conan-favicon.png"/>
    <link rel="canonical" href="https://docs.conan.io/integrations/cross_platform/yocto.html" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=f2f60bec"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Android" href="android.html" />
    <link rel="prev" title="QNX Neutrino" href="qnx_neutrino.html" />


<script
  data-cfasync="false"
  data-tracker-overrides="GoogleConsentMode:security_storage=on;ad_storage=SaleOfInfo,Advertising;ad_user_data=SaleOfInfo,Advertising;ad_personalization=SaleOfInfo,Advertising;analytics_storage=Analytics,SaleOfInfo;functionality_storage=Functional,SaleOfInfo;personalization_storage=Functional,SaleOfInfo"
  src="https://transcend-cdn.com/cm/f0071674-c641-4cf3-9d31-303ec0c86b1b/airgap.js" data-languages="en"
></script>
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://gtm.jfrog.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-WK44ZFM');</script>
<!-- End Google Tag Manager -->
<script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {dataLayer.push(arguments);}
      gtag("js", new Date());
      gtag("config", "GTM-WK44ZFM");
      gtag('set', 'developer_id.dODQ2Mj', true);
</script>

 



</script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/conan-logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.60
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../conan_v2.html">Conan migration guide to 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../training_courses.html">Training Courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using_packages.html">Using packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../creating_packages.html">Creating Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../uploading_packages.html">Uploading Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developing_packages.html">Developing packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devtools.html">Package apps and devtools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../versioning.html">Versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mastering.html">Mastering Conan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../systems_cross_building.html">Systems and cross building</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../extending.html">Extending Conan</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../integrations.html">Integrations</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../compilers.html">Compilers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../build_system.html">Build systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ides.html">IDEs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ci.html">CI Platforms</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../cross_platform.html">Other Systems</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="buildroot.html"> Buildroot</a></li>
<li class="toctree-l3"><a class="reference internal" href="docker.html"> Docker</a></li>
<li class="toctree-l3"><a class="reference internal" href="emscripten.html"> Emscripten</a></li>
<li class="toctree-l3"><a class="reference internal" href="qnx_neutrino.html"> QNX Neutrino</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#"> Yocto</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#integration-with-conan">Integration with Conan</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-conan-packages-with-yocto-s-sdk">Creating Conan packages with Yocto’s SDK</a></li>
<li class="toctree-l4"><a class="reference internal" href="#deploying-an-application-to-a-yocto-image">Deploying an application to a Yocto image</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="android.html"> Android</a></li>
<li class="toctree-l3"><a class="reference internal" href="ios.html">iOS, tvOS, watchOS</a></li>
<li class="toctree-l3"><a class="reference internal" href="vxworks.html"> VxWorks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../vcs.html">Version Control System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../custom.html">Custom integrations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../linting.html">Linting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deployment.html">Deployment</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../howtos.html">Howtos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cheatsheet.html">Cheatsheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../videos.html">Videos and links</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">conan</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div class="admonition warning wy-text-center" style="position:sticky;top:0;background: #fcfcfc;padding: inherit;z-index:1" id="conan-banners">
            
            <div style="border: 2px solid #eb8484;background-color: #ffcaca;padding: 3px;margin-bottom: 5px">
              <p>This document is for a <b>"1.X" legacy</b> Conan version, <b>which is no longer recommended</b>. Please update to Conan 2, <a href="https://docs.conan.io/2/">click here to read the <b>Conan 2</b> documentation</a></p>
            </div>
            
            <div style="border: 2px solid #4a7d7e; background-color: #e6f2f2; padding: 8px">
                <p>
                  📖 The Conan 2 essentials training is now available in the JFrog Academy for free.
                  <a href="https://academy.jfrog.com/conan-2-essentials?utm_source=Conan+Docs" target="_blank">Register now</a>.
                </p>
              </div>                                                  
          </div>
          <!--@ OUTDATED_VERSION_PLACEHOLDER_BEGIN @
          <div>
            <div class="admonition warning wy-text-center" style="position:sticky">
              <p>This document is for an <b>outdated</b> Conan version.
              <a href="https://docs.conan.io/2/@LATEST_DOC_PAGE_URL@">Click here to read the <b>latest</b> documentation</a></p>
             </div>
          </div>
          @ OUTDATED_VERSION_PLACEHOLDER_END @-->
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../integrations.html">Integrations</a></li>
          <li class="breadcrumb-item"><a href="../cross_platform.html">Other Systems</a></li>
      <li class="breadcrumb-item active"> Yocto</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/conan-io/docs/blob/master/integrations/cross_platform/yocto.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="yocto-logo-yocto">
<span id="yocto-integration"></span><h1><a class="reference internal" href="../../_images/conan-yocto.png"><img alt="yocto_logo" src="../../_images/conan-yocto.png" style="width: 180px;" /></a> Yocto<a class="headerlink" href="#yocto-logo-yocto" title="Link to this heading"></a></h1>
<p>The <a class="reference external" href="https://www.yoctoproject.org/">Yocto Project</a> is an open-source project that delivers a set of tools that create operating system images for embedded Linux systems.
The Yocto Project tools are based on the <a class="reference external" href="http://www.openembedded.org/wiki/Main_Page">OpenEmbedded</a> project, which uses the BitBake build tool, to construct complete Linux images.</p>
<p>Yocto supports several Linux host distributions and it also provides a way to install the correct version of these tools by either
downloading a buildtools-tarball or building one on a supported machine. This allows virtually any Linux distribution to be able to run
Yocto, and also makes sure that it will be possible to replicate your Yocto build system in the future. The Yocto Project build system also
isolates itself from the host distribution’s C library, which makes it possible to share build caches between different distributions and
also helps in future-proofing the build system.</p>
<section id="integration-with-conan">
<h2>Integration with Conan<a class="headerlink" href="#integration-with-conan" title="Link to this heading"></a></h2>
<p>You can create Conan packages building with the Yocto SDK as any other package for other configuration. Those packages can be integrated
into a Yocto build installing them from a remote and without compiling them again.</p>
<p>Three stages can be differentiated in the proposed flow:</p>
<p>1. Developers can create an application with the native tools in their desktop platform of choice using their usual IDE, compiler or
debugger and test the application.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/conan-yocto_development.png"><img alt="../../_images/conan-yocto_development.png" class="align-center" src="../../_images/conan-yocto_development.png" style="width: 600px; height: 600px;" /></a>
</div></blockquote>
<ol class="arabic" start="2">
<li><p>Packages can be cross-built for the target device using the Yocto SDK and uploaded to Artifactory, even automated in a CI process.</p>
<a class="reference internal image-reference" href="../../_images/conan-yocto_cross-build.png"><img alt="../../_images/conan-yocto_cross-build.png" class="align-center" src="../../_images/conan-yocto_cross-build.png" style="width: 600px; height: 600px;" /></a>
</li>
<li><p>Once the cross-built packages are available in Artifactory, the application can be directly deployed to the Yocto image without building
it from sources again.</p>
<a class="reference internal image-reference" href="../../_images/conan-yocto_deploy.png"><img alt="../../_images/conan-yocto_deploy.png" class="align-center" src="../../_images/conan-yocto_deploy.png" style="width: 450px; height: 450px;" /></a>
</li>
</ol>
</section>
<section id="creating-conan-packages-with-yocto-s-sdk">
<h2>Creating Conan packages with Yocto’s SDK<a class="headerlink" href="#creating-conan-packages-with-yocto-s-sdk" title="Link to this heading"></a></h2>
<section id="prepare-your-recipes">
<h3>Prepare your recipes<a class="headerlink" href="#prepare-your-recipes" title="Link to this heading"></a></h3>
<p>First of all, the recipe of the application to be deployed to the final image should have a
<a class="reference external" href="https://docs.conan.io/en/latest/devtools/running_packages.html">deploy() method</a>. There you can specify the files of the application
needed in the image as well as any other from its dependencies (like shared libraries or assets):</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>conan<span class="w"> </span>install
:caption:<span class="w"> </span>*conanfile.py*
:emphasize-lines:<span class="w"> </span><span class="m">28</span>-31

<span class="w"> </span>from<span class="w"> </span>conans<span class="w"> </span>import<span class="w"> </span>ConanFile


<span class="w"> </span>class<span class="w"> </span>FoobarConan<span class="o">(</span>ConanFile<span class="o">)</span>:
<span class="w">     </span><span class="nv">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;foobar&quot;</span>
<span class="w">     </span>...

<span class="w"> </span>def<span class="w"> </span>package<span class="o">(</span>self<span class="o">)</span>:
<span class="w">     </span>self.copy<span class="o">(</span><span class="s2">&quot;*.h&quot;</span>,<span class="w"> </span><span class="nv">dst</span><span class="o">=</span><span class="s2">&quot;include&quot;</span>,<span class="w"> </span><span class="nv">src</span><span class="o">=</span><span class="s2">&quot;hello&quot;</span><span class="o">)</span>
<span class="w">     </span>self.copy<span class="o">(</span><span class="s2">&quot;*.so&quot;</span>,<span class="w"> </span><span class="nv">dst</span><span class="o">=</span><span class="s2">&quot;lib&quot;</span>,<span class="w"> </span><span class="nv">keep_path</span><span class="o">=</span>False<span class="o">)</span>
<span class="w">     </span>self.copy<span class="o">(</span><span class="s2">&quot;*.a&quot;</span>,<span class="w"> </span><span class="nv">dst</span><span class="o">=</span><span class="s2">&quot;lib&quot;</span>,<span class="w"> </span><span class="nv">keep_path</span><span class="o">=</span>False<span class="o">)</span>
<span class="w">     </span>self.copy<span class="o">(</span><span class="s2">&quot;foobar&quot;</span>,<span class="w"> </span><span class="nv">dst</span><span class="o">=</span><span class="s2">&quot;bin&quot;</span>,<span class="w"> </span><span class="nv">keep_path</span><span class="o">=</span>False<span class="o">)</span>

<span class="w"> </span>def<span class="w"> </span>deploy<span class="o">(</span>self<span class="o">)</span>:
<span class="w">     </span><span class="c1"># Deploy the executables from this eclipse/mosquitto package</span>
<span class="w">     </span>self.copy<span class="o">(</span><span class="s2">&quot;*&quot;</span>,<span class="w"> </span><span class="nv">src</span><span class="o">=</span><span class="s2">&quot;bin&quot;</span>,<span class="w"> </span><span class="nv">dst</span><span class="o">=</span><span class="s2">&quot;bin&quot;</span><span class="o">)</span>
<span class="w">     </span><span class="c1"># Deploy the shared libs from this eclipse/mosquitto package</span>
<span class="w">     </span>self.copy<span class="o">(</span><span class="s2">&quot;*.so*&quot;</span>,<span class="w"> </span><span class="nv">src</span><span class="o">=</span><span class="s2">&quot;lib&quot;</span>,<span class="w"> </span><span class="nv">dst</span><span class="o">=</span><span class="s2">&quot;bin&quot;</span><span class="o">)</span>
<span class="w">    </span><span class="c1"># Deploy all the shared libs from the transitive deps</span>
<span class="w">     </span>self.copy_deps<span class="o">(</span><span class="s2">&quot;*.so*&quot;</span>,<span class="w"> </span><span class="nv">src</span><span class="o">=</span><span class="s2">&quot;lib&quot;</span>,<span class="w"> </span><span class="nv">dst</span><span class="o">=</span><span class="s2">&quot;bin&quot;</span><span class="o">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Another option is using the <a class="reference external" href="https://docs.conan.io/en/latest/reference/generators/deploy.html">deploy generator</a> generator,</dt><dd><p>which will copy all artifacts, including package dependencies to your installation folder.</p>
</dd>
</dl>
</section>
<section id="setting-up-a-yocto-sdk">
<h3>Setting up a Yocto SDK<a class="headerlink" href="#setting-up-a-yocto-sdk" title="Link to this heading"></a></h3>
<p>Yocto SDKs are completely self-contained, there is no dependency on libraries of the build machine or tools installed in it. The SDK is a
cross-building toolchain matching the target and it is generated from that specific configuration. This means that you will have to use a
different SDK toolchain to build for a different target architecture or that some SDK’s may have specific settings to enable some system
dependency of the final target and those libraries will be available in the SDK.</p>
<p>You can <a class="reference external" href="https://www.yoctoproject.org/docs/2.6/sdk-manual/sdk-manual.html#sdk-building-an-sdk-installer">create your own Yocto SDKs</a>
or download and use <a class="reference external" href="http://downloads.yoctoproject.org/releases/yocto/yocto-2.6.2/toolchain/x86_64/">the prebuilt ones</a>.</p>
<p><strong>In the case that you are using CMake</strong> to create the Conan packages, Yocto injects a toolchain that configures CMake to only search for
libraries in the rootpath of the SDK with
<a class="reference external" href="https://cmake.org/cmake/help/v3.0/variable/CMAKE_FIND_ROOT_PATH.html#variable:CMAKE_FIND_ROOT_PATH">CMAKE_FIND_ROOT_PATH</a>. This is
something that has to be patched to allow CMake to find libraries in the Conan cache as well:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text"><em>sdk/sysroots/x86_64-pokysdk-linux/usr/share/cmake/OEToolchainConfig.cmake</em></span><a class="headerlink" href="#id1" title="Link to this code"></a></div>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="nb">set</span><span class="p">(</span><span class="w"> </span><span class="s">CMAKE_FIND_ROOT_PATH</span><span class="w"> </span><span class="o">$ENV{</span><span class="nv">OECORE_TARGET_SYSROOT</span><span class="o">}</span><span class="w"> </span><span class="o">$ENV{</span><span class="nv">OECORE_NATIVE_SYSROOT</span><span class="o">}</span><span class="w"> </span><span class="p">)</span>
<span class="w"> </span><span class="nb">set</span><span class="p">(</span><span class="w"> </span><span class="s">CMAKE_FIND_ROOT_PATH_MODE_PROGRAM</span><span class="w"> </span><span class="s">NEVER</span><span class="w"> </span><span class="p">)</span>
<span class="w"> </span><span class="c"># COMMENT THIS: set( CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY )</span>
<span class="w"> </span><span class="c"># COMMENT THIS: set( CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY )</span>
<span class="w"> </span><span class="c"># COMMENT THIS: set( CMAKE_FIND_ROOT_PATH_MODE_PACKAGE ONLY )</span>
</pre></div>
</div>
</div>
<p>You can read more about those variables here:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://cmake.org/cmake/help/v3.0/variable/CMAKE_FIND_ROOT_PATH_MODE_LIBRARY.html">CMAKE_FIND_ROOT_PATH_MODE_LIBRARY</a></p></li>
<li><p><a class="reference external" href="https://cmake.org/cmake/help/v3.0/variable/CMAKE_FIND_ROOT_PATH_MODE_INCLUDE.html">CMAKE_FIND_ROOT_PATH_MODE_INCLUDE</a></p></li>
<li><p><a class="reference external" href="https://cmake.org/cmake/help/v3.0/variable/CMAKE_FIND_ROOT_PATH_MODE_PACKAGE.html">CMAKE_FIND_ROOT_PATH_MODE_PACKAGE</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="cross-building-conan-packages-with-the-sdk-toolchain">
<h3>Cross-building Conan packages with the SDK toolchain<a class="headerlink" href="#cross-building-conan-packages-with-the-sdk-toolchain" title="Link to this heading"></a></h3>
<p>After setting up your desired SDK, you can start creating Conan packages setting up the environment of the Yocto SDK and running a
<strong class="command">conan create</strong> command with a suitable profile with the specific architecture of the toolchain.</p>
<p>For example, creating packages for <cite>arch=armv8</cite>:</p>
<p>The profile will be:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text"><em>armv8</em></span><a class="headerlink" href="#id2" title="Link to this code"></a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span> [settings]
 os_build=Linux
 arch_build=x86_64
 os=Linux
 arch=armv8
 compiler=gcc
 compiler.version=8
 compiler.libcxx=libstdc++11
 build_type=Release
</pre></div>
</div>
</div>
<p>Activate the SDK environment and execute the create command if you have a specific recipe:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">source</span><span class="w"> </span>oe-environment-setup-aarch64-poky-linux
$<span class="w"> </span>conan<span class="w"> </span>create<span class="w"> </span>.<span class="w"> </span>user/channel<span class="w"> </span>--profile<span class="w"> </span>armv8
</pre></div>
</div>
<p>However, if you wish an official Conan package from Conan Center, you can install it directly:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">source</span><span class="w"> </span>oe-environment-setup-aarch64-poky-linux
$<span class="w"> </span>conan<span class="w"> </span>install<span class="w"> </span>mosquitto/2.0.14@<span class="w"> </span>-g<span class="w"> </span>deploy<span class="w"> </span>--profile:build<span class="o">=</span>default<span class="w"> </span>--profile:host<span class="o">=</span>armv8
</pre></div>
</div>
<p>This will generate the packages using the Yocto toolchain from the environment variables such as <code class="docutils literal notranslate"><span class="pre">CC</span></code>, <code class="docutils literal notranslate"><span class="pre">CXX</span></code>, <code class="docutils literal notranslate"><span class="pre">LD</span></code>… Now you can
<a class="reference internal" href="../../uploading_packages.html#uploading-packages"><span class="std std-ref">upload the binaries</span></a> to an Artifactory server to share and reuse in your Yocto builds.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>conan<span class="w"> </span>upload<span class="w"> </span>mosquitto/2.0.14@<span class="w"> </span>--all<span class="w"> </span>--remote<span class="w"> </span>my_repo
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>We strongly recommend using the Yocto’s SDK toolchain to create packages as they will be built with the optimization flags suitable to
be deployed later to an image generated in a Yocto build.</p>
</div>
</section>
</section>
<section id="deploying-an-application-to-a-yocto-image">
<h2>Deploying an application to a Yocto image<a class="headerlink" href="#deploying-an-application-to-a-yocto-image" title="Link to this heading"></a></h2>
<p>Now that you have your cross-built Conan packages in Artifactory, you can deploy them in a Yocto build.</p>
<section id="set-up-the-conan-layer">
<h3>Set up the Conan layer<a class="headerlink" href="#set-up-the-conan-layer" title="Link to this heading"></a></h3>
<p>We have created a <a class="reference external" href="https://github.com/conan-io/meta-conan">meta-conan</a> layer that includes all the configuration, the Conan client and a
generic BitBake recipe. To add the layer you will have to clone the repository and the dependency layers of <code class="docutils literal notranslate"><span class="pre">meta-openembedded</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>poky
$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/conan-io/meta-conan.git
$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>--branch<span class="w"> </span>thud<span class="w"> </span>https://github.com/openembedded/meta-openembedded.git
</pre></div>
</div>
<p>You would also have to activate the layers in the <em>bblayers.conf</em> file of your build folder:</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text"><em>conf/bblayers.conf</em></span><a class="headerlink" href="#id3" title="Link to this code"></a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span> POKY_BBLAYERS_CONF_VERSION = &quot;2&quot;

 BBPATH = &quot;${TOPDIR}&quot;
 BBFILES ?= &quot;&quot;

 BBLAYERS ?= &quot; \
 /home/username/poky/meta \
 /home/username/poky/meta-poky \
 /home/username/poky/meta-yocto-bsp \
 /home/username/poky/meta-openembedded/meta-oe \
 /home/username/poky/meta-openembedded/meta-python \
 /home/username/poky/meta-conan \
 &quot;
</pre></div>
</div>
</div>
<p>Or, if you are not confident editing the configuration file or just to automate all process, you can use bitbake commands:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>build/
$<span class="w"> </span>bitbake-layers<span class="w"> </span>add-layer<span class="w"> </span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/../poky/meta-openembedded/meta-oe
$<span class="w"> </span>bitbake-layers<span class="w"> </span>add-layer<span class="w"> </span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/../poky/meta-openembedded/meta-python
$<span class="w"> </span>bitbake-layers<span class="w"> </span>add-layer<span class="w"> </span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/../poky/meta-conan
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please report any question, feature request or issue related to the <code class="docutils literal notranslate"><span class="pre">meta-conan</span></code> layer in its
<a class="reference external" href="https://github.com/conan-io/meta-conan/issues">GitHub issue tracker</a>.</p>
</div>
</section>
<section id="write-the-bitbake-recipe-for-the-conan-package">
<h3>Write the Bitbake recipe for the Conan package<a class="headerlink" href="#write-the-bitbake-recipe-for-the-conan-package" title="Link to this heading"></a></h3>
<p>With the <code class="docutils literal notranslate"><span class="pre">meta-conan</span></code> layer, a Conan recipe to deploy a Conan package should look as easy as this recipe:</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text"><em>conan-mosquitto_2.0.14.bb</em></span><a class="headerlink" href="#id4" title="Link to this code"></a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span> inherit conan

 DESCRIPTION = &quot;An open source MQTT broker&quot;
 LICENSE = &quot;EPL-1.0&quot;

 CONAN_PKG = &quot;mosquitto/2.0.14@&quot;
</pre></div>
</div>
</div>
<p>This recipe will be placed inside your application layer that should be also added to the <em>conf/bblayers.conf</em> file.</p>
</section>
<section id="configure-conan-variables-for-the-build">
<h3>Configure Conan variables for the build<a class="headerlink" href="#configure-conan-variables-for-the-build" title="Link to this heading"></a></h3>
<p>Additionally to the recipe, you will need to provide the information about the credentials for Artifactory or the profile to be used to
retrieve the packages in the <em>local.conf</em> file of your build folder.</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text"><em>poky_build_folder/conf/local.conf</em></span><a class="headerlink" href="#id5" title="Link to this code"></a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span> IMAGE_INSTALL_append = &quot; conan-mosquitto&quot;

 # Profile for installation
 CONAN_PROFILE_PATH = &quot;${TOPDIR}/conf/armv8&quot;
 # Artifactory repository
 CONAN_REMOTE_URL = &quot;https://localhost:8081/artifactory/api/conan/&lt;repository&gt;&quot;
 # Artifactory Credentials
 CONAN_USER = &quot;REPO_USER&quot;
 CONAN_PASSWORD = &quot;REPO_PASSWORD&quot;
</pre></div>
</div>
</div>
<p>Notice the <em>armv8</em> profile to indicate your configuration next to the <em>local.conf</em>. That way you will be able to match the Conan
configuration with the specific architecture or board of your Yocto build.</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text"><em>poky_build_folder/conf/armv8</em></span><a class="headerlink" href="#id6" title="Link to this code"></a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span> [settings]
 os_build=Linux
 arch_build=x86_64
 os=Linux
 arch=armv8
 compiler=gcc
 compiler.version=8
 compiler.libcxx=libstdc++11
 build_type=Release
</pre></div>
</div>
</div>
<p>It is recommended to set up the specific profile to use in your build with <code class="docutils literal notranslate"><span class="pre">CONAN_PROFILE_PATH</span></code> pointing to profile stored in the
configuration folder of your build (next to the <em>conf/local.conf</em> file), for example: <code class="docutils literal notranslate"><span class="pre">CONAN_PROFILE_PATH</span> <span class="pre">=</span> <span class="pre">&quot;${TOPDIR}/conf/armv8&quot;</span></code>.</p>
<p>Finally, the Artifactory repository URL where you want to retrieve the packages from and its credentials.</p>
<p>You can also use <code class="docutils literal notranslate"><span class="pre">CONAN_CONFIG_URL</span></code> with a custom Conan configuration to be used with <strong class="command">conan config install</strong> and the name of the
profile to use in <code class="docutils literal notranslate"><span class="pre">CONAN_PROFILE_PATH</span></code> and just the name of the remote in <code class="docutils literal notranslate"><span class="pre">CONAN_REMOTE_NAME</span></code>. For example:</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text"><em>poky_build_folder/conf/local.conf</em></span><a class="headerlink" href="#id7" title="Link to this code"></a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span> IMAGE_INSTALL_append = &quot; conan-mosquitto&quot;

 CONAN_CONFIG_URL = &quot;https://github.com/&lt;your-organization&gt;/conan-config.git&quot;
 CONAN_PROFILE_PATH = &quot;armv8&quot;
 CONAN_REMOTE_NAME = &quot;my_repo&quot;
 CONAN_USER = &quot;REPO_USER&quot;
 CONAN_PASSWORD = &quot;REPO_PASSWORD&quot;
</pre></div>
</div>
</div>
<p>In this case the <em>armv8</em> profile and the <code class="docutils literal notranslate"><span class="pre">my_repo</span></code> remote will be taken from the ones installed with the <strong class="command">conan config install</strong>
command.</p>
<section id="architecture-conversion-table">
<h4>Architecture conversion table<a class="headerlink" href="#architecture-conversion-table" title="Link to this heading"></a></h4>
<p>If no specific profile is indicated in <code class="docutils literal notranslate"><span class="pre">CONAN_PROFILE_PATH</span></code>, Conan will map the most common Yocto architectures and machines to the
existing ones in Conan. This is the current mapping from Conan architectures to the Yocto ones:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Yocto SDK</strong></p></th>
<th class="head"><p><strong>Yocto Machine</strong></p></th>
<th class="head"><p><strong>Conan arch setting</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>aarch64</p></td>
<td><p>qemuarm64</p></td>
<td><p>armv8</p></td>
</tr>
<tr class="row-odd"><td><p>armv5e</p></td>
<td><p>qemuarmv5</p></td>
<td><p>armv5el</p></td>
</tr>
<tr class="row-even"><td><p>core2-64</p></td>
<td><p>qemux86_64</p></td>
<td><p>x86_64</p></td>
</tr>
<tr class="row-odd"><td><p>cortexa8hf</p></td>
<td><p>quemuarm</p></td>
<td><p>armv7hf</p></td>
</tr>
<tr class="row-even"><td><p>i586</p></td>
<td><p>qemux86</p></td>
<td><p>x86</p></td>
</tr>
<tr class="row-odd"><td><p>mips32r2</p></td>
<td><p>qemumips</p></td>
<td><p>mips</p></td>
</tr>
<tr class="row-even"><td><p>mips64</p></td>
<td><p>qemumips64</p></td>
<td><p>mips64</p></td>
</tr>
<tr class="row-odd"><td><p>ppc7400</p></td>
<td><p>qemuppc</p></td>
<td><p>ppc32</p></td>
</tr>
</tbody>
</table>
<p>This mapping may not be complete and some of the binaries generated with the Yocto toolchains will have specific optimization flags for
the specific architectures.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For heavy Yocto users, having a custom setting for this may be very useful. For example, including the specific architecture names in
your <em>settings.yml</em></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">arch</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">...</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;aarch64&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;armv5e&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;core2-64&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">...</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>Or using a <code class="docutils literal notranslate"><span class="pre">machine</span></code> subsetting under the <code class="docutils literal notranslate"><span class="pre">Linux</span></code> operating system:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">os</span><span class="p">:</span>
<span class="w">    </span><span class="nt">Linux</span><span class="p">:</span>
<span class="w">        </span><span class="nt">machine</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">None</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;qemuarm64&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;qemuarm64&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;qemux86_64&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">...</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">None</span></code> value is important here to be able to build other packages without value for this subsetting to target a
non-yocto Linux distro.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p>Yocto Machine configurations: <a class="reference external" href="https://git.yoctoproject.org/cgit.cgi/poky/tree/meta/conf/machine">https://git.yoctoproject.org/cgit.cgi/poky/tree/meta/conf/machine</a></p></li>
<li><p>Conan Architectures in <a class="reference internal" href="../../reference/config_files/settings.yml.html#settings-yml"><span class="std std-ref">settings.yml</span></a>.</p></li>
</ul>
</div>
</section>
</section>
<section id="deploy-the-application-and-its-dependencies-to-the-final-image">
<h3>Deploy the application and its dependencies to the final image<a class="headerlink" href="#deploy-the-application-and-its-dependencies-to-the-final-image" title="Link to this heading"></a></h3>
<p>You can build the recipe to test that the packages are correctly deployed:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>bitbake<span class="w"> </span>-c<span class="w"> </span>install<span class="w"> </span>conan-mosquitto
</pre></div>
</div>
<p>Packages will be installed with the profile indicated and installed with its dependencies only from the remote specified.</p>
<p>Finally, you can build your image with the Conan packages:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>bitbake<span class="w"> </span>core-image-minimal
</pre></div>
</div>
<p>The binaries of <strong>the Conan packages will be deployed</strong> to the <em>/bin</em> folder of the image once it is created.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="qnx_neutrino.html" class="btn btn-neutral float-left" title="QNX Neutrino" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="android.html" class="btn btn-neutral float-right" title="Android" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2022, JFrog.
      <span class="lastupdated">Last updated on Sep 29, 2025.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    Version: 1.60
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
    <dt>Versions</dt>
    
        
            <dd><a href="/2.21/index.html">2.21</a></dd>
        
    
        
            <dd><a href="/2.20/index.html">2.20</a></dd>
        
    
        
            <dd><a href="/2.19/index.html">2.19</a></dd>
        
    
        
            <dd><a href="/2.18/index.html">2.18</a></dd>
        
    
        
            <dd><a href="/2.17/index.html">2.17</a></dd>
        
    
        
            <dd><a href="/2.16/index.html">2.16</a></dd>
        
    
        
            <dd><a href="/2.15/index.html">2.15</a></dd>
        
    
        
            <dd><a href="/2.14/index.html">2.14</a></dd>
        
    
        
            <dd><a href="/2.13/index.html">2.13</a></dd>
        
    
        
            <dd><a href="/2.12/index.html">2.12</a></dd>
        
    
        
            <dd><a href="/2.11/index.html">2.11</a></dd>
        
    
        
            <dd><a href="/2.10/index.html">2.10</a></dd>
        
    
        
            <dd><a href="/2.9/index.html">2.9</a></dd>
        
    
        
            <dd><a href="/2.8/index.html">2.8</a></dd>
        
    
        
            <dd><a href="/2.7/index.html">2.7</a></dd>
        
    
        
            <dd><a href="/2.6/index.html">2.6</a></dd>
        
    
        
            <dd><a href="/2.5/index.html">2.5</a></dd>
        
    
        
            <dd><a href="/2.4/index.html">2.4</a></dd>
        
    
        
            <dd><a href="/2.3/index.html">2.3</a></dd>
        
    
        
            <dd><a href="/2.2/index.html">2.2</a></dd>
        
    
        
            <dd><a href="/2.1/index.html">2.1</a></dd>
        
    
        
            <dd><a href="/2.0/index.html">2.0</a></dd>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
            <dd><a href="/2/index.html">2</a></dd>
        
    
    <br>
        <details>
            <summary>Conan 1 releases</summary>
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
            <dd><a href="/1/index.html">1</a></dd>
        
    
        
            <dd><a href="/en/1.66/index.html">1.66</a></dd>
        
    
        
            <dd><a href="/en/1.65/index.html">1.65</a></dd>
        
    
        
            <dd><a href="/en/1.64/index.html">1.64</a></dd>
        
    
        
            <dd><a href="/en/1.63/index.html">1.63</a></dd>
        
    
        
            <dd><a href="/en/1.62/index.html">1.62</a></dd>
        
    
        
            <dd><a href="/en/1.61/index.html">1.61</a></dd>
        
    
        
            <dd><a href="/en/1.60/index.html">1.60</a></dd>
        
    
        
            <dd><a href="/en/1.59/index.html">1.59</a></dd>
        
    
        
            <dd><a href="/en/1.58/index.html">1.58</a></dd>
        
    
        
            <dd><a href="/en/1.57/index.html">1.57</a></dd>
        
    
        
            <dd><a href="/en/1.56/index.html">1.56</a></dd>
        
    
        
            <dd><a href="/en/1.55/index.html">1.55</a></dd>
        
    
        
            <dd><a href="/en/1.54/index.html">1.54</a></dd>
        
    
        
            <dd><a href="/en/1.53/index.html">1.53</a></dd>
        
    
        
            <dd><a href="/en/1.52/index.html">1.52</a></dd>
        
    
        
            <dd><a href="/en/1.51/index.html">1.51</a></dd>
        
    
        
            <dd><a href="/en/1.50/index.html">1.50</a></dd>
        
    
        
            <dd><a href="/en/1.49/index.html">1.49</a></dd>
        
    
        
            <dd><a href="/en/1.48/index.html">1.48</a></dd>
        
    
        
            <dd><a href="/en/1.47/index.html">1.47</a></dd>
        
    
        
            <dd><a href="/en/1.46/index.html">1.46</a></dd>
        
    
        
            <dd><a href="/en/1.45/index.html">1.45</a></dd>
        
    
        
            <dd><a href="/en/1.44/index.html">1.44</a></dd>
        
    
        
            <dd><a href="/en/1.43/index.html">1.43</a></dd>
        
    
        
            <dd><a href="/en/1.42/index.html">1.42</a></dd>
        
    
        
            <dd><a href="/en/1.41/index.html">1.41</a></dd>
        
    
        
            <dd><a href="/en/1.40/index.html">1.40</a></dd>
        
    
        
            <dd><a href="/en/1.39/index.html">1.39</a></dd>
        
    
        
            <dd><a href="/en/1.38/index.html">1.38</a></dd>
        
    
        
            <dd><a href="/en/1.37/index.html">1.37</a></dd>
        
    
        
            <dd><a href="/en/1.36/index.html">1.36</a></dd>
        
    
        
            <dd><a href="/en/1.35/index.html">1.35</a></dd>
        
    
        
            <dd><a href="/en/1.34/index.html">1.34</a></dd>
        
    
        
            <dd><a href="/en/1.33/index.html">1.33</a></dd>
        
    
        
            <dd><a href="/en/1.32/index.html">1.32</a></dd>
        
    
        
            <dd><a href="/en/1.31/index.html">1.31</a></dd>
        
    
        
            <dd><a href="/en/1.30/index.html">1.30</a></dd>
        
    
        
            <dd><a href="/en/1.29/index.html">1.29</a></dd>
        
    
        
            <dd><a href="/en/1.28/index.html">1.28</a></dd>
        
    
        
            <dd><a href="/en/1.27/index.html">1.27</a></dd>
        
    
        
            <dd><a href="/en/1.26/index.html">1.26</a></dd>
        
    
        
            <dd><a href="/en/1.25/index.html">1.25</a></dd>
        
    
        
            <dd><a href="/en/1.24/index.html">1.24</a></dd>
        
    
        
            <dd><a href="/en/1.23/index.html">1.23</a></dd>
        
    
        
            <dd><a href="/en/1.22/index.html">1.22</a></dd>
        
    
        
            <dd><a href="/en/1.21/index.html">1.21</a></dd>
        
    
        
            <dd><a href="/en/1.20/index.html">1.20</a></dd>
        
    
        
            <dd><a href="/en/1.19/index.html">1.19</a></dd>
        
    
        
            <dd><a href="/en/1.18/index.html">1.18</a></dd>
        
    
        
            <dd><a href="/en/1.17/index.html">1.17</a></dd>
        
    
        
            <dd><a href="/en/1.16/index.html">1.16</a></dd>
        
    
        
            <dd><a href="/en/1.15/index.html">1.15</a></dd>
        
    
        
            <dd><a href="/en/1.14/index.html">1.14</a></dd>
        
    
        
            <dd><a href="/en/1.13/index.html">1.13</a></dd>
        
    
        
            <dd><a href="/en/1.12/index.html">1.12</a></dd>
        
    
        
            <dd><a href="/en/1.11/index.html">1.11</a></dd>
        
    
        
            <dd><a href="/en/1.10/index.html">1.10</a></dd>
        
    
        
            <dd><a href="/en/1.9/index.html">1.9</a></dd>
        
    
        
            <dd><a href="/en/1.8/index.html">1.8</a></dd>
        
    
        
            <dd><a href="/en/1.7/index.html">1.7</a></dd>
        
    
        
            <dd><a href="/en/1.6/index.html">1.6</a></dd>
        
    
        
            <dd><a href="/en/1.5/index.html">1.5</a></dd>
        
    
        
            <dd><a href="/en/1.4/index.html">1.4</a></dd>
        
    
        
            <dd><a href="/en/1.3/index.html">1.3</a></dd>
        
    
        
    
        </details>
    </dl>
    <dl>
        <dt>Downloads</dt>
        
            <dd><a href="/en/1.60/conan.pdf">PDF</a></dd>
        
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

<noscript><iframe src="https://gtm.jfrog.com/ns.html?id=GTM-WK44ZFM" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>


 


</body>
</html>